# Quick Reference: Converting Prompts to Code Tasks
**Purpose:** 1-page cheat sheet for the entire system  
**When to use:** Before starting any new code task  

---

## üéØ THE 5-STEP FORMULA

```
EXTRACT          ARCHITECTURE      CODE            TESTS             DEPLOY
(5 min)          (10 min)          (30 min)        (20 min)          (10 min)
     ‚Üì                ‚Üì                 ‚Üì               ‚Üì                 ‚Üì
What/Why/How    Data + Algorithm  JSDoc + Error   Unit + Edge +     File paths
Inputs/Outputs  Functions         Handling        Distribution       Integration
Success         Error cases       Examples        Self-tests         Checklist
Dependencies    Performance       Production      Commands           Common errors
```

---

## STEP 1: EXTRACT (5 minutes)

**Ask these questions:**

1. **What am I building?**
   - Feature? Component? Algorithm? Integration?
   - One sentence: "I need [X] to [verb] [object]"

2. **Why does it matter?**
   - Business impact? Revenue? User experience?
   - How is this tied to MaxClaim's model?

3. **What are inputs & outputs?**
   - Example input: `{ id: 1, bid: 15 }`
   - Example output: `[P2, P1, P3]`

4. **What does it depend on?**
   - Other modules? Database? External APIs?
   - Current availability: yes/no?

5. **How do I know it works?**
   - Measurable success criteria
   - Example: "distribution within 2%"

**Checklist:**
```
‚ñ° Requirement is 1 sentence
‚ñ° Example input provided
‚ñ° Example output provided
‚ñ° Business value stated
‚ñ° Dependencies listed
```

---

## STEP 2: ARCHITECTURE (10 minutes)

**Define these elements:**

### 1. DATA STRUCTURES
```javascript
// What does the input look like?
Input: {
  id: string,
  name: string,
  bid: number,
  weight: number  // calculated
}

// What does the output look like?
Output: [
  { ...input1 },
  { ...input2 },
  { ...input3 }
]
```

### 2. ALGORITHM (Plain English)
```
1. Calculate total weight (sum all weights)
2. Generate random number 0 to total
3. Iterate through partners, subtract weight
4. When random <= 0, select partner
5. Remove from pool, repeat
```

### 3. FUNCTION SIGNATURE
```javascript
getWeightedPartners(partners: Array, count: number = 3): Array
```

### 4. ERROR CASES
```
‚ñ° Empty array ‚Üí return []
‚ñ° count > array length ‚Üí return all
‚ñ° Invalid weight ‚Üí use default 1
‚ñ° Missing fields ‚Üí handle gracefully
```

### 5. PERFORMANCE TARGET
```
Time: O(n * count)
Space: O(count)
Expected: <50ms for 100+ items
```

**Checklist:**
```
‚ñ° Input data structure defined
‚ñ° Output data structure defined
‚ñ° Algorithm in plain English
‚ñ° Function signature specified
‚ñ° All error cases identified
‚ñ° Performance targets set
```

---

## STEP 3: CODE (30 minutes)

**Write production code with:**

### 1. JSDoc COMMENTS
```javascript
/**
 * [What it does - 1 sentence]
 * 
 * [Detailed explanation if needed]
 * 
 * @param {Type} name - Description
 * @returns {Type} Description
 * 
 * @example
 * // Show usage example
 */
```

### 2. INPUT VALIDATION
```javascript
if (!input || typeof input !== 'object') {
  console.warn('[module] Invalid input');
  return defaultValue;
}
```

### 3. ERROR HANDLING
```javascript
try {
  // Logic
} catch (error) {
  console.error('[module]', error);
  return fallbackValue;
}
```

### 4. CLEAR LOGIC
```javascript
// ‚úì GOOD: Variable names are clear, logic is obvious
const totalWeight = partners.reduce((sum, p) => sum + p.weight, 0);

// ‚úó AVOID: Unclear what this does
const t = p.reduce((a,b)=>a+b.w,0);
```

### 5. MEANINGFUL COMMENTS
```javascript
// ‚úì GOOD: Explains WHY
// Cap weight at 10x to prevent extreme bid distortion

// ‚úó AVOID: Explains WHAT (code already shows)
// Set weight to 10
weight = 10;
```

**Checklist:**
```
‚ñ° Every function has JSDoc
‚ñ° Parameters documented
‚ñ° Return type documented
‚ñ° Usage examples provided
‚ñ° Input validation present
‚ñ° Error cases handled
‚ñ° Variable names are clear
‚ñ° Comments explain WHY
‚ñ° No hardcoded values (except constants)
‚ñ° No console.log() in production
```

---

## STEP 4: TESTS (20 minutes)

**Three types of tests:**

### 1. UNIT TESTS (Happy Path)
```javascript
test('should return correct count', () => {
  const result = getWeightedPartners(partners, 3);
  expect(result).toHaveLength(3);
});
```

### 2. EDGE CASE TESTS
```javascript
test('should handle empty array', () => {
  const result = getWeightedPartners([], 3);
  expect(result).toEqual([]);
});

test('should not return duplicates', () => {
  const ids = result.map(p => p.id);
  expect(new Set(ids).size).toBe(ids.length);
});
```

### 3. SELF-TESTS (In Production Code)
```javascript
export function runSelfTests() {
  // 5-10 quick tests
  // Run on module load
  // Alert if failures
}
```

### 4. DISTRIBUTION TEST (For Probabilistic Functions)
```javascript
const stats = testDistribution(partners, 1000);
// Verify: Partner A: 11%, Partner B: 41%, Partner C: 27%
// Within ¬±2% tolerance
```

**Checklist:**
```
‚ñ° Unit tests for happy path
‚ñ° Edge case tests
‚ñ° Error case tests
‚ñ° Self-tests in code
‚ñ° Distribution tests (if probabilistic)
‚ñ° Performance tests (if critical)
‚ñ° All tests passing
‚ñ° >80% code coverage
```

---

## STEP 5: DEPLOY (10 minutes)

**Document these:**

### 1. FILE PATHS
```
Copy to: src/utils/myModule.js
Already in correct format, no changes needed.
```

### 2. IMPORT
```javascript
import { getWeightedPartners } from './src/utils/adRotation.js';
```

### 3. INTEGRATION EXAMPLE
```javascript
// In server.js
app.get('/api/partners/:trade', (req, res) => {
  const partners = applyWeights(PARTNERS);
  const top3 = getWeightedPartners(partners, 3);
  res.json({ partners: top3 });
});
```

### 4. TEST COMMANDS
```bash
# Run unit tests
npm test -- adRotation.test.js

# Run self-tests
node -e "import('./src/utils/adRotation.js').then(m => m.runSelfTests());"

# Test API
curl "http://localhost:3000/api/partners/Roofing?zip=78701"
```

### 5. DEPLOYMENT CHECKLIST
```
‚ñ° Code copied to correct path
‚ñ° No console.log() in production
‚ñ° All JSDoc complete
‚ñ° Tests created and passing
‚ñ° Self-tests run successfully
‚ñ° API endpoint wired
‚ñ° Error handling verified
‚ñ° Tested with real data
‚ñ° Performance acceptable
‚ñ° Ready for production
```

---

## üìä TASK TEMPLATE

**Use this for every new task:**

```markdown
# CODE TASK X.X: [Name]
**ID:** X.X  
**Time:** [hours]  
**Status:** READY FOR EXECUTION  

## EXTRACTION (Copy from requirements)
WHAT: ...
WHY: ...
INPUT: ...
OUTPUT: ...
DEPS: ...
SUCCESS: ...

## ARCHITECTURE
Data: ...
Algorithm: ...
Signature: ...
Errors: ...
Performance: ...

## CODE
[Production code with JSDoc]

## TESTS
[Unit + edge + distribution + self-tests]

## DEPLOYMENT
Files: ...
Import: ...
Integration: ...
Tests: ...
Checklist: ...
```

---

## ‚è±Ô∏è TIME BREAKDOWN

| Step | Time | Output |
|------|------|--------|
| Extract | 5 min | Requirement specification |
| Architecture | 10 min | Design document |
| Code | 30 min | Production-ready code |
| Tests | 20 min | Complete test suite |
| Deploy | 10 min | Integration guide |
| **TOTAL** | **~75 min** | **Complete task** |

---

## üöÄ EXECUTION CHECKLIST

### Before Starting
- [ ] Have you read the requirements?
- [ ] Have you looked at Task 1.1 as an example?
- [ ] Do you understand the 5 steps?

### During Extraction
- [ ] Stated requirement in 1 sentence?
- [ ] Found example inputs/outputs?
- [ ] Identified all dependencies?
- [ ] Defined success criteria?

### During Architecture
- [ ] Designed data structures?
- [ ] Described algorithm?
- [ ] Listed error cases?
- [ ] Set performance targets?

### During Code
- [ ] Written production code?
- [ ] Added JSDoc comments?
- [ ] Handled all errors?
- [ ] Code is ready to copy/paste?

### During Tests
- [ ] Written unit tests?
- [ ] Covered edge cases?
- [ ] Added self-tests?
- [ ] All tests passing?

### During Deployment
- [ ] Specified file paths?
- [ ] Provided import statements?
- [ ] Wrote integration examples?
- [ ] Created deployment checklist?

### Before Merging
- [ ] Code reviewed?
- [ ] Tests passing?
- [ ] Documentation complete?
- [ ] Performance acceptable?
- [ ] Ready for production?

---

## üí° PRO TIPS

1. **Study Task 1.1 first** - It's the reference example for this system
2. **Copy the template** - Use the structure from 1.1 for new tasks
3. **Time yourself** - Are you on track with 75 min per task?
4. **Test early** - Write tests as you code, not after
5. **Read comments** - JSDoc explains the architecture
6. **Ask for help** - If stuck, review the full documentation
7. **Deploy often** - Test each task before moving to next

---

## üîó FULL DOCUMENTATION

- **Prompts-to-Code-System.md** - Complete system explanation
- **CODE-TASK-1.1-Weighted-Rotation.md** - Reference example
- **CODE-TASK-1.2-Carrier-Intel.md** - Second example
- **CODE-TASKS-Master-Index.md** - All 14 tasks + timeline

---

**Status:** READY TO USE ‚úÖ  
**Print this:** YES, keep it handy  
**Review before each task:** YES, every time  

**Let's build this.** üöÄ

